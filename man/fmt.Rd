% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmt_class.R
\name{fmt}
\alias{fmt}
\alias{new_fmt}
\alias{is_fmt}
\alias{get_display}
\alias{get_n}
\alias{get_wn}
\alias{get_pct}
\alias{get_diff}
\alias{get_digits}
\alias{get_ctr}
\alias{get_mean}
\alias{get_var}
\alias{get_ci}
\alias{is_totrow}
\alias{is_refrow}
\alias{is_tottab}
\alias{get_type}
\alias{get_comp_all}
\alias{get_diff_type}
\alias{get_ci_type}
\alias{get_col_var}
\alias{is_totcol}
\alias{is_refcol}
\alias{get_color}
\alias{set_display}
\alias{set_n}
\alias{set_wn}
\alias{set_pct}
\alias{set_diff}
\alias{set_digits}
\alias{set_ctr}
\alias{set_mean}
\alias{set_var}
\alias{set_ci}
\alias{as_totrow}
\alias{as_refrow}
\alias{as_tottab}
\alias{set_col_var}
\alias{as_totcol}
\alias{as_refcol}
\alias{set_type}
\alias{set_diff_type}
\alias{set_ci_type}
\alias{set_color}
\alias{set_comp}
\alias{get_num}
\alias{set_num}
\title{Create a vector of class formatted numbers}
\usage{
fmt(
  n = integer(),
  type = "n",
  digits = rep(0L, length(n)),
  display = dplyr::case_when(type == "mean" ~ "mean", type \%in\% c("row", "col",
    "all", "all_tabs") ~ "pct", TRUE ~ "n"),
  wn = rep(NA_real_, length(n)),
  pct = rep(NA_real_, length(n)),
  mean = rep(NA_real_, length(n)),
  diff = rep(NA_real_, length(n)),
  ctr = rep(NA_real_, length(n)),
  var = rep(NA_real_, length(n)),
  ci = rep(NA_real_, length(n)),
  in_totrow = rep(FALSE, length(n)),
  in_tottab = rep(FALSE, length(n)),
  in_refrow = rep(FALSE, length(n)),
  comp_all = NA,
  diff_type = "",
  ci_type = "",
  col_var = "",
  totcol = FALSE,
  refcol = FALSE,
  color = ""
)

new_fmt(
  n = integer(),
  type = "n",
  digits = rep(0L, length(n)),
  display = dplyr::case_when(type == "mean" ~ "mean", type \%in\% c("row", "col",
    "all", "all_tabs") ~ "pct", TRUE ~ "n"),
  wn = rep(NA_real_, length(n)),
  pct = rep(NA_real_, length(n)),
  mean = rep(NA_real_, length(n)),
  diff = rep(NA_real_, length(n)),
  ctr = rep(NA_real_, length(n)),
  var = rep(NA_real_, length(n)),
  ci = rep(NA_real_, length(n)),
  in_totrow = rep(FALSE, length(n)),
  in_tottab = rep(FALSE, length(n)),
  in_refrow = rep(FALSE, length(n)),
  comp_all = NA,
  diff_type = "",
  ci_type = "",
  col_var = "",
  totcol = FALSE,
  refcol = FALSE,
  color = "",
  ...,
  class = character()
)

is_fmt(x)

get_display(fmt)

get_n(fmt)

get_wn(fmt)

get_pct(fmt)

get_diff(fmt)

get_digits(fmt)

get_ctr(fmt)

get_mean(fmt)

get_var(fmt)

get_ci(fmt)

is_totrow(x, ...)

is_refrow(x, ...)

is_tottab(x, ...)

get_type(x, ...)

get_comp_all(x, replace_na = TRUE)

get_diff_type(x, ...)

get_ci_type(x, ...)

get_col_var(x, ...)

is_totcol(x, ...)

is_refcol(x, ...)

get_color(x, ...)

set_display(fmt, value)

set_n(fmt, value)

set_wn(fmt, value)

set_pct(fmt, value)

set_diff(fmt, value)

set_digits(fmt, value)

set_ctr(fmt, value)

set_mean(fmt, value)

set_var(fmt, value)

set_ci(fmt, value)

as_totrow(fmt, in_totrow = TRUE)

as_refrow(fmt, in_refrow = TRUE)

as_tottab(fmt, in_tottab = TRUE)

set_col_var(fmt, col_var)

as_totcol(fmt, totcol = TRUE)

as_refcol(fmt, refcol = TRUE)

set_type(fmt, type)

set_diff_type(fmt, diff_type)

set_ci_type(fmt, ci_type)

set_color(fmt, color)

set_comp(fmt, value = c("tab", "all"))

get_num(x)

set_num(x, value)
}
\arguments{
\item{n}{The underlying count, as an integer vector of length \code{n()}. It is used
to calculate confidence intervals for percentages.}

\item{type}{The type of the column, which defines the type of background calculation
to be made :
\itemize{
\item \code{"n"}: counts
\item \code{"mean"}: mean column (from numeric variables)
\item \code{"row"}: row percentages
\item \code{"col"}: column percentages
\item \code{"all"}: frequencies by subtable/group (i.e. by \code{tab_vars})
\item \code{"all_tabs"}: frequencies for the whole table
}}

\item{digits}{The number of digits, as an integer, or an integer vector the length
of \code{n}.}

\item{display}{The display type : the name of the field you want to show when printing
the vector. Among \code{"n"}, \code{"wn"}, \code{"pct"}, \code{"diff"}, \code{"ctr"},
\code{"mean"}, \code{"var"}, \code{"ci"},
\code{"pct_ci"} (percentages with visible confidence interval),
\code{"mean_ci"} (means with visible confidence interval). As a single string, or a
character vector the length of \code{n}.}

\item{wn}{The underlying weighted counts, as a double vector the length of
\code{n}. It is used in certain operations on \code{\link{fmt}}, like means.}

\item{pct}{The percentages, as a double vector the length of \code{n}.
Calculate with \code{\link{tab_pct}}.}

\item{mean}{The means, as a double vector the length of \code{n}.}

\item{diff}{The differences (from totals or first cells),
as a double vector the length of \code{n}. Used to set colors for means and
row or col percentages. Calculate with \code{\link{tab_pct}}.}

\item{ctr}{The contributions of cells to (sub)tables variances,
as a double vector the length of \code{n}. Used to print colors when
\code{color = "contrib"}. The mean contribution of each (sub)table is written on
total rows (then, colors don't print well without total rows).
Calculate with \code{\link{tab_chi2}}.}

\item{var}{The cells variances, as a double vector the length of \code{n}.
Used with \code{type = "mean"} to calculate confidence intervals.
Calculate with \code{tab_core}.}

\item{ci}{The confidence intervals, as a double vector the length of \code{n}.
Used to print colors (\code{"diff_ci"}, \code{"after_ci"}).
Calculate with \code{tab_ci}.}

\item{in_totrow}{\code{TRUE} when the cell is part of a total row}

\item{in_tottab}{\code{TRUE} when the cell is part of a total table}

\item{in_refrow}{\code{TRUE} when the cell is part of a reference row
(cf. \code{diff_type})}

\item{comp_all}{\code{FALSE} when the comparison level is the subtable/group,
\code{TRUE} when it is the whole table}

\item{diff_type}{The type of difference of the vector (calculate
with \code{\link{tab_pct}}) :
\itemize{
\item \code{""} or \code{"no"}: no differences have been calculated
\item \code{"tot"}: the reference row (or column) is the total row (or column)
\item \code{"first"}: the reference row (or column) is the first row (or column)
}}

\item{ci_type}{The type of confidence intervals of the vector (calculate
with \code{\link{tab_ci}}) :
\itemize{
\item \code{""} or \code{"no"}: no ci have been calculated
\item \code{"cell"}: absolute confidence intervals of cells percentages.
\item \code{"diff"}: confidence intervals of the difference between a cell and the
relative total cell (or relative first cell when \code{diff_type = "first"}).
\item \code{"auto"}: \code{"diff"} for means and row/col percentages,
\code{"cell"} for frequencies ("all", "all_tabs").
}}

\item{col_var}{The name of the \code{col_var} used to calculate the vector}

\item{totcol}{\code{TRUE} when the vector is a total column}

\item{refcol}{\code{TRUE} when the vector is a reference column}

\item{color}{The type of color to print :
\itemize{
\item \code{"no"}: no colors are printed.
\item \code{"diff"}: color percentages and means based on cells differences from
totals (or from first cells when \code{diff = "first"}).
\item \code{"diff_ci"}: color pct and means based on cells differences from totals
or first cells, removing coloring when the confidence interval of this difference
is higher than the difference itself.
\item \code{"after_ci"}: idem, but cut off the confidence interval from the
difference first.
\item \code{"contrib"}: color cells based on their contribution to variance
(except mean columns, from numeric variables).
}}

\item{...}{Used in methods to add arguments in the future.}

\item{class}{Subclasses to assign to the new object, default: none.}

\item{x}{The object to test.}

\item{fmt}{The formatted number in which you want to find data for "get" functions,
to modify data for "set" functions.}

\item{replace_na}{By default, \code{\link{get_comp_all}} takes NA in comparison level
to be a \code{FALSE} (=comparison at subtables/groups level). Set to \code{FALSE}
to avoid this behavior.}

\item{value}{The value you want to inject in some \code{fmt} vector's field
or attribute using a given "set" function.}
}
\value{
A vector of class \code{fmt}.
}
\description{
\code{fmt} vectors are the class that powers \pkg{tabxplor} and
\code{\link{tab}} tibbles.
As a \code{\link[vctrs:new_rcrd]{record}}, it stores all data necessary to
calculate percentages, Chi2 metadata or confidence intervals, but also to format and
color the table to help the user to read it. You can access this data, or change it,
using a whole set of functions made to work with tabxplor formatted numbers.
\code{fmt} vectors can use all standard operations, like +, -, sum(), or c(),
using \pkg{vctrs}.
}
\section{Functions}{
\itemize{
\item \code{new_fmt}: a constructor for class fmt.

\item \code{is_fmt}: a test function for class fmt.

\item \code{get_display}: get the "display" field of a \code{fmt} vector

\item \code{get_n}: get the "n" field (unweighted counts)

\item \code{get_wn}: get the "wn" field (weighted counts)

\item \code{get_pct}: get the "pct" field

\item \code{get_diff}: get the "pct" field

\item \code{get_digits}: get the "diff" field (differences from totals or first cells)

\item \code{get_ctr}: get the "ctr" field (relative contributions of cells to variance)

\item \code{get_mean}: get the "mean" field

\item \code{get_var}: get the "var" field (cell variances of means)

\item \code{get_ci}: get the "ci" field (confidence intervals)

\item \code{is_totrow}: test function to detect cells in total rows
(at \code{fmt} level or \code{tab} level)

\item \code{is_refrow}: test function to detect cells in reference rows
(at \code{fmt} level or \code{tab} level)

\item \code{is_tottab}: test function to detect cells in total tables
(at \code{fmt} level or \code{tab} level)

\item \code{get_type}: get types of fmt columns (at \code{fmt} level or \code{tab} level)

\item \code{get_comp_all}: get comparison level of fmt columns

\item \code{get_diff_type}: get differences type of fmt columns (at \code{fmt} level or \code{tab} level)

\item \code{get_ci_type}: get confidence intervals type of fmt columns
(at \code{fmt} level or \code{tab} level)

\item \code{get_col_var}: get names of column variable of fmt columns
(at \code{fmt} level or \code{tab} level)

\item \code{is_totcol}: test function for total columns
(at \code{fmt} level or \code{tab} level)

\item \code{is_refcol}: test function for reference columns
(at \code{fmt} level or \code{tab} level)

\item \code{get_color}: get color (at \code{fmt} level or \code{tab} level)

\item \code{set_display}: set the "display" field of a \code{fmt} vector

\item \code{set_n}: set the "n" field (unweighted counts)

\item \code{set_wn}: set the "wn" field (weighted counts)

\item \code{set_pct}: set the "pct" field

\item \code{set_diff}: set the "diff" field

\item \code{set_digits}: set the "digits" field (differences from totals or first cells)

\item \code{set_ctr}: set the "ctr" field (relative contributions of cells to variance)

\item \code{set_mean}: set the "mean" field

\item \code{set_var}: set the "var" field (cell variances of means)

\item \code{set_ci}: set the "ci" field (confidence intervals)

\item \code{as_totrow}: set the "in_totrow" field (belong to total row)

\item \code{as_refrow}: set the "in_refrow" field (belong to reference row)

\item \code{as_tottab}: set the "in_tottab" field (belong to total table)

\item \code{set_col_var}: set the "col_var" attribute of a \code{fmt} vector

\item \code{as_totcol}: set the "totcol" attribute of a \code{fmt} vector

\item \code{as_refcol}: set the "ref_col" attribute of a \code{fmt} vector

\item \code{set_type}: set the column type attribute of a \code{fmt} vector

\item \code{set_diff_type}: set the differences type attribute of a \code{fmt} vector

\item \code{set_ci_type}: set the confidence intervals type attribute of a \code{fmt} vector

\item \code{set_color}: set the color attribute of a \code{fmt} vector

\item \code{set_comp}: set the comparison level attribute of a \code{fmt} vector

\item \code{get_num}: get the currently displayed field

\item \code{set_num}: set the currently displayed field (not changing display type)
}}

\examples{
fmt(7, "row", pct = 0.6)
}
