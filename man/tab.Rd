% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tablr_classes.R, R/tablr_create.R
\name{is_tab}
\alias{is_tab}
\alias{tab}
\title{Crosstabs}
\usage{
is_tab(x)

tab(
  data,
  var1,
  var2,
  var3,
  wt,
  show_na = TRUE,
  keep_unused_levels = FALSE,
  tot = "auto",
  perc = c("no", "row", "col", "all", "all_tabs"),
  totaltab = c("table", "line", "no"),
  digits = 0,
  cleannames = FALSE,
  subtext,
  sort_by = "no",
  minimum_headcount = 30,
  rare_to_other = FALSE,
  another_total = FALSE,
  sup_contrib = FALSE,
  result = c("observed", "contrib", "expected", "spread", "binding_ratio", "ctr_abs",
    "ctr_no_sign"),
  force_unique_table = FALSE,
  accelerate = FALSE
)
}
\arguments{
\item{data}{A data frame.}

\item{var1, var2, var3}{\code{var1} is the row variable. \code{var2} is the
column variable. A table is made for each level in \code{var3} :
leave this table variable empty to make a simple crosstab. All variables
will be converted to factor.}

\item{wt}{A weight variable, of class numeric. Leave empty for unweighted
results.}

\item{show_na}{Set to \code{FALSE} to exclude individuals with \code{NA} at
\code{var1}, \code{var2} or \code{var3}.}

\item{keep_unused_levels}{Set to \code{TRUE} to keep empty levels of factors.}

\item{tot}{\code{"auto"} prints all totals, unless it is a one-variable
table. \code{"no"} remove them all, \code{"row"} add a total row, \code{"col"}
a total column, and \code{"all"} and \code{c("row", "col")} stand for both.}

\item{perc}{Type of percentages. \code{"no"}, \code{"row"} and \code{"col"}
are self-evident. \code{"all"} print frequencies for each table.
If \code{var3} is provided, \code{"all_tabs"} calculate the proportion
of each value in the total population.}

\item{totaltab}{Only useful when \code{var3} is provided. \code{"table"}
means that a totaltable will be created. \code{"line"} means it will be
reduced to a single row. \code{"no"}  means it will be totally removed.}

\item{digits}{The number of digits to print, as an integer.}

\item{cleannames}{Set to \code{TRUE} to clean levels names, by removing
prefix numbers like "1-", and text in parenthesis.}

\item{subtext}{A character vector to print legend rows under the
(list of) table(s) in \code{\link{tab_xl}}}

\item{sort_by}{A variable to sort rows in each table with. It must be one
of the principal or supplementary column variables.}

\item{minimum_headcount}{The minimum unweighted count in each row/col.
Any row/col with less count will be printed in grey in \code{\link{tab_xl}}.}

\item{rare_to_other}{When set to \code{TRUE}, levels with less count
than minimum_headcount will be merged into an "Other" level.}

\item{another_total}{Set to \code{TRUE} to add another total line.
Useful to compare row frequencies with \code{perc = "row"}, or columns
frequencies with \code{perc = "col"}. It only prints when you pass tabs
into \code{\link{tab_xl}}.}

\item{sup_contrib}{Add a column and a row with the contribution of all levels
to the variance of the tabs. It only prints when you pass tabs
into \code{\link{tab_xl}}.}

\item{result}{Any intermediate result in the calculation of Chi2/variance
can be printed :
\itemize{
\item \code{"observed"} : base table with counts or frequencies
\item \code{"contrib"} : contribution of cells to variance, with signs + or -
for attractions and repulsions
\item \code{"expected"} : expected frequencies
\item \code{"spread"} : spread between observed and expected frequencies
\item \code{"binding_ratio"} : spread divided by expected frequencies
\item \code{"ctr_abs"} : absolute contributions of cells to variance
\item \code{"ctr_no_sign"} : relative contributions of cells to variance
}}

\item{force_unique_table}{If \code{var3} is provided, set to
\code{TRUE} to print multiple tables into one.}

\item{accelerate}{If \code{TRUE} makes the function faster, but produces
less metadata (Chi2, unweighted counts, contributions of cells to variance).}
}
\value{
If \code{var3} is empty, a single table with
class \code{\link{single_tab}}, which is a special
\code{\link[tibble]{tibble}} with adapted printing method.
If \code{var3} is provided, a list of single tables, with class
\code{\link{tab}} (a list of \code{\link[tibble]{tibble}}).
The variables classes depend on the chosen parameters (\code{\link{pct}},
\code{double}, \code{character}). You can then add supplementary rows or
cols with \code{\link{tab_sup}}. You can also modify tables with any
function using \code{\link{tab_map}} (better not to directly use
\code{purrr::\link[purrr]{map}}, which removes attributes).
}
\description{
A full-featured function to create, manipulate and print
crosstabs. It can be decomposed in several functions : data is prepared with
\code{\link{tab_prepare}} ; calculations are made on a single dataframe
with \code{\link{tab_df}} ; the result is finally "widened" and split
in as many tables as necessary with \code{\link{tab_draw}}.
You can then modify tables with any functions using \code{\link{tab_map}}.
}
\section{Functions}{
\itemize{
\item \code{is_tab}: A test function for class tab (list of tables)
}}

\examples{
tab(forcats::gss_cat, marital, race)

tab(forcats::gss_cat, marital, race, perc = "row")

tab(forcats::gss_cat, marital, race, year, perc = "row")

dplyr::storms \%>\%
  tab(status, category) \%>\%
  tab_sup(sup_rows = c("pressure", "wind"), print_sup = TRUE)

\dontrun{
forcats::gss_cat \%>\%
  tabw(marital, race, perc = "row") \%>\%
  tab_xl()
}

# To program several tables with different parameters at the same time :
purrr::pmap(
  tibble::tribble(
    ~var1    , ~var2 ,  ~perc,
    "marital", "race",  "no" ,
    "marital", "race",  "row",
    "marital", "race",  "col",
    "relig"  , "race",  "no" ,
    "relig"  , "race",  "row",
    "relig"  , "race",  "col",
  ),
  .f = tab,
  data = forcats::gss_cat, sort_by = c("White", "desc")) #\%>\%
#tab_xl(only_one_sheet = TRUE)
}
