% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabxl2.R
\name{tab_xl}
\alias{tab_xl}
\title{Crosstabs : Excel output with conditional formatting}
\usage{
tab_xl(
  tabs,
  path = "Tabs\\\\Tab",
  replace = FALSE,
  open = rlang::is_interactive(),
  colnames_rotation = 0,
  remove_tab_vars = TRUE,
  colwidth = "auto",
  print_ci = TRUE,
  print_color_legend = TRUE,
  sheets = "tabs",
  min_counts = 30,
  hide_near_zero = "auto",
  pct_breaks = get_color_breaks("pct"),
  mean_breaks = get_color_breaks("mean"),
  contrib_breaks = get_color_breaks("contrib")
)
}
\arguments{
\item{tabs}{Table(s) created with \code{\link{tab}}. Strictly speaking, it
can be an object of class \code{\link{single_tab}}, several of them
gathered in a \code{\link{tab}}, or a list code{\link{tab}}.}

\item{path, replace, open}{The name, and possibly the path, of the Excel file
to create (without the .xlsx extension). Default path to working directory.
Use \code{replace = TRUE} to overwrite existing files. Use \code{open = TRUE}
if you don't want to automatically open the tables in Excel (or another
software associated with .xlsx files).}

\item{colnames_rotation}{Rotate the names of columns to an angle (in degrees).}

\item{hide_near_zero}{By default, values printed as 0 are automatically
colored in light gray in Excel, to help to focus on other ones. Use doubles
to set the value under which numbers are colored in gray.
\code{hide_near_zero = Inf} if you don't want to use this feature.}

\item{pct_breaks}{The values to use to color deviations from the mean,
when the table shows \code{"row"} or \code{"col"} percentages and
\code{color = "auto"}. They must be numbers between - 1 and 1
(i.e. -100\% and +100\%).}

\item{contrib_breaks}{The values to use to color cell
contributions to variance : \code{1} means above/under the average
contribution of cells to variance, \code{10} means 10 times the average
contribution. Must be positive numbers for
attractions (green), negative numbers for repulsions (orange).}

\item{digits_perc}{Number of digits to print for percentages.}

\item{digits_no_perc}{Number of digits to print for counts.}

\item{digits_quanti}{Number of digits to print for quantitative variables.}

\item{unique_sheet}{When \code{TRUE}, all tables are printed on the
same sheet.}

\item{color}{Color cells, based on their deviation from the mean, using
Excel conditional formatting. In rows and cols, attractions /
over-represented levels are colored in shades of green,
and aversions / under-represented levels are colored in shades of orange.
\itemize{
\item \code{"auto"} : tabs with \code{"row"} or \code{"col"} percentages
are colored based on deviations from margins,
other tabs on contributions to variance
\item \code{"contrib"} : for all tabs, color intensity is based on the
relative contribution of cells to variance (Chi2 metric)
\item \code{"no"} : no conditional formatting
}}

\item{compact}{Create the more compact table possible by removing
unnecessary rows (Chi2, unweighted counts, \code{sup_rows}). Useful if there
is \code{var3}/\code{tab_var}.}
}
\value{
An Excel file with the tables as a side-effect. Invisibly returns
\code{tabs}.
}
\description{
Crosstabs : Excel output with conditional formatting
}
\examples{
\dontrun{
forcats::gss_cat \%>\%
tabw(marital, race, perc = "row") \%>\%
  tab_xl()

forcats::gss_cat \%>\%
  tabw(marital, race) \%>\%
  tab_xl()
  }
}
